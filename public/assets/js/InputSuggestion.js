!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Suggestion=e():t.Suggestion=e()}(self,(function(){return(()=>{"use strict";var t={d:(e,i)=>{for(var a in i)t.o(i,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:i[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{CreateList:()=>n});var i=function(t){var e,i=t.tagname,a=t.classnames,s=t.content;return e=i?document.createElement(i):document.createElement("div"),a&&(e.className=a),s&&(e.innerHTML=s),e};function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function s(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var n=function(){function t(e,i){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var s=this.input=document.querySelector(e);if(this.cooldown=!1,s.hasAttribute("data-suggestions"))this._data=JSON.parse(s.getAttribute("data-suggestions"));else if(s.hasAttribute("list")){var n=s.getAttribute("list"),r=document.querySelectorAll("datalist#".concat(n," option")),o=[];r.forEach((function(t){o.push(t.getAttribute("value"))})),this._data=o,s.removeAttribute("list")}else{if(null==i)return console.error("No data specified"),!1;var l=i;"string"==typeof l&&(l=JSON.parse(l)),this._data=l}s.autocomplete="Nawh",s.hasAttribute("data-labels")&&(labels=s.getAttribute("data-labels")),this.render(),this.preventDisappear(),s.addEventListener("focus",(function(t){return a.showList()})),s.addEventListener("blur",(function(t){return a.hideList()})),s.addEventListener("input",(function(t){return a.searchItem()}))}var e,n;return e=t,(n=[{key:"cloneInitList",value:function(){var t=this.list.querySelectorAll("li");if(t.length)for(var e=0;e<3&&t[e];e++)this.fakeList.append(t[e].cloneNode(!0));else this.fakeList.append(i({tagname:"li",classnames:"text-center",content:"No suggestion"}))}},{key:"hideList",value:function(){this.cannotFade||this.justOpened||(this.fakeList.classList.remove("show"),this.fakeList.removeAttribute("style"))}},{key:"preventDisappear",value:function(){var t=this;this.fakeList.addEventListener("mouseenter",(function(e){return t.cannotFade=!0})),this.fakeList.addEventListener("mouseleave",(function(e){return t.cannotFade=!1}))}},{key:"refreshData",value:function(t){this._data=t,"object"!==a(t)&&(this._data=Json.parse(t)),this.fakeList.innerHTML="",this.renderDataToDropdown(),this.cloneInitList()}},{key:"render",value:function(){this.renderDataToDropdown(),this.renderDisplayList()}},{key:"renderDataToDropdown",value:function(){var t=this;if(this._dataIsObject=!0,this.list){var e=this.list;e.innerHTML="","object"!==a(this._data[0])&&(this._dataIsObject=!1),this.renderListItem(e)}else{var s=this.list=i({tagname:"ul",classnames:"dropdown-menu"});"object"!==a(this._data[0])&&(this._dataIsObject=!1),this.renderListItem(s),document.addEventListener("click",(function(e){var i=e.target;t.selectItem(i)}))}}},{key:"renderDisplayList",value:function(){for(this.fakeList=this.list.cloneNode(!0),this.fakeList.children.length||this.fakeList.append(i({tagname:"li",classnames:"text-center",content:"No suggestion"}));this.fakeList.children.length>3;)this.fakeList.removeChild(this.fakeList.lastChild);var t=this.input.nextElementSibling;t&&"DATALIST"!=t.nodeName&&!t.hasAttribute("data-bs-toggle")?this.input.parentNode.insertBefore(this.fakeList,this.input.nextElementSibling):this.input.parentNode.append(this.fakeList)}},{key:"renderListItem",value:function(t){var e=this;this._data.forEach((function(a){var s=i({tagname:"li"});if(e._dataIsObject){var n='<div class="dropdown-item"><p class="lead">'.concat(a.value,"</p>");for(var r in a.attributes)if(Object.hasOwnProperty.call(a.attributes,r)){var o,l=a.attributes[r];o=e.keyLabel?e.keyLabel[r]:r,n+='<div><span class="font-weight-bold">'.concat(o,"</span>: ").concat(l,"</div>")}n+="</div>",s.innerHTML=n,s.setAttribute("data-value",a.value),s.setAttribute("data-attributes",JSON.stringify(a.attributes))}else s.innerHTML='<div class="dropdown-item">'.concat(a,"</div>"),s.setAttribute("data-value",a);s.style.cursor="pointer",s.setAttribute("data-suggestion-item",""),t.append(s)}))}},{key:"searchItem",value:function(){var t=this;if(!this.cooldown){if(this.cooldown=!0,this.fakeList.innerHTML="",""!=this.input.value){var e=Array.from(this.list.querySelectorAll("li")).filter((function(e){return e.getAttribute("data-value").includes(t.input.value)}));if(e.length)for(var a=0;a<3&&e[a];a++)this.fakeList.append(e[a].cloneNode(!0));else this.fakeList.append(i({tagname:"li",classnames:"text-center",content:"Nothing matches"}))}else this.cloneInitList();setTimeout((function(){return t.cooldown=!1}),150)}}},{key:"selectItem",value:function(t){var e=t,i=!1;for(this.cannotFade=!1;!e.hasAttribute("data-suggestion-item");)if((e=e.parentNode)==document.body){i=!0;break}if(!i&&(this.hideList(),this.selected&&this.selected.classList.remove("active"),this.selected=e,this.selected.classList.add("active"),this.input.value=e.getAttribute("data-value"),e.hasAttribute("data-attributes"))){var a=JSON.parse(e.getAttribute("data-attributes"));if(this._selectCallback&&"function"==typeof this._selectCallback)this._selectCallback(a);else for(var s in a)if(Object.hasOwnProperty.call(a,s)){var n=a[s];document.querySelector("input[name='".concat(s,"']")).value=n}}}},{key:"showList",value:function(){var t=this;this.justOpened=!0,this.fakeList.style="position: absolute; margin: 0; width: ".concat(this.input.clientWidth,"px"),this.fakeList.classList.add("show"),setTimeout((function(){return t.justOpened=!1}),500)}},{key:"labels",set:function(t){"string"==typeof t?this.keyLabel=JSON.parse(t):"object"==a(t)&&(this.keyLabel=t)}},{key:"selectCallback",set:function(t){this._selectCallback=t}}])&&s(e.prototype,n),t}();return e})()}));