!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var s=e();for(var i in s)("object"==typeof exports?exports:t)[i]=s[i]}}(self,(()=>(()=>{"use strict";var t={};(t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})})(t);class e extends HTMLElement{static observedAttributes=[];requiredAttributes=[];castAttributes=[];availableAttributes=[];constructor(){super(),this.attr={},this.rendered=!1;for(let t of this.getAttributeNames())t in this.constructor.observedAttributes&&this.storeAttribute(t,this.getAttribute(t))}attributeChangedCallback(t,e,s){this._storeAttribute(t,s),this.isConnected&&this.rendered&&this._render()}connectedCallback(){this._render(),this.rendered=!0}_storeAttribute(t,e=""){t in this.castAttributes?Array.isArray(this.castAttributes[t])?this.castAttributes[t].includes(e)&&(this.attr[t]=e):"object"==this.castAttributes[t]?this.attr[t]=JSON.parse(e):"integer"==this.castAttributes[t]?this.attr[t]=parseInt(e):"boolean"==this.castAttributes[t]&&(e=e.toLowerCase(),this.attr[t]=("true"===e||"1"===e)&&""!==e):this.attr[t]=e}_validateAttr(){let t="";return this.requiredAttributes.forEach((e=>{e in this.attr||(t+=`${e} is missing; \n                `)})),{error:""!=t,message:t}}_render(){}}const s=e;class i extends s{static data={};static fetching=!1;constructor(){if(super(),!Object.keys(i.data).length&&!i.fetching){i.fetching=!0;let t=window.location.href,e=t.indexOf("/app/"),s=document.documentElement.lang.toLowerCase();e<=0&&(e=t.length),t=t.substring(0,e),t+=`/resources/lang/${s}.json`,fetch(t).then((t=>t.ok?t.json():(t.text().then((t=>console.error(t))),!1))).then((t=>{i.data=t,i.fetching=!1,document.querySelectorAll("tl-str").forEach((t=>{t.refresh()}))})).catch((t=>console.error(t)))}}_render(){let t=this.innerHTML;t in i.data&&(this.innerHTML=i.data[t])}refresh(){this._render()}}const a=i,r=(t,e={})=>{for(const s in e)if(Object.hasOwnProperty.call(e,s)){const i=e[s],a=new RegExp(`{{${s}}}`,"g");t=t.replace(a,i)}return t};return customElements.define("tl-str",a),customElements.define("form-btn",class extends s{static observedAttributes=["method","text","url","type","icon","icon-type"];requiredAttributes=["method","text","url","type"];constructor(){super()}_render(){const t=this._validateAttr();if(t.error)return void console.error(t.message);"button"==this.attr.type?this.className="btn btn-primary":"dropdown-item"==this.attr.type&&this.classList.add("dropdown-item","pe-auto","has-icon");const e=document.createElement("form");if(e.setAttribute("action",this.attr.url),"post"==this.attr.method.toLowerCase()||"put"==this.attr.method.toLowerCase()||"delete"==this.attr.method.toLowerCase()){const t=document.createElement("input"),s=document.createElement("input");t.value=this.attr.method,t.type="hidden",t.name="_method",s.value=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),s.type="hidden",s.name="_token",e.setAttribute("method","POST"),e.append(t),e.append(s)}else e.setAttribute("method","GET");let s="";s="icon"in this.attr&&"icon-type"in this.attr?`<i class="fa-${this.attr["icon-type"]} fa-${this.attr.icon}"></i> ${this.attr.text}`:this.attr.text,this.innerHTML=s,this.append(e),this.addEventListener("click",(t=>{e.submit()}))}}),customElements.define("act-item",class extends s{static observedAttributes=["icon","icon-type","title","details","details-highlight","action-modal","action-modal-title","action-text","action-url","action-method"];requiredAttributes=["icon","icon-type","title","details"];castAttributes=[];constructor(){super()}_render(){const t=this._validateAttr();if(t.error)return void console.error(t.message);let e="",s="";if("action-text"in this.attr&&"action-url"in this.attr)if("action-method"in this.attr)e=r('<form-btn method="{{method}}" text="{{text}}" type="button" url="{{url}}"> </form-btn>',{method:this.attr["action-method"],text:this.attr["action-text"],url:this.attr["action-url"]});else{let t=this.attr["action-url"];"action-modal"in this.attr&&"action-modal-title"in this.attr&&(t="#!",e=`\n                    data-ajax-popup="true"\n                    data-title="${this.attr["action-modal-title"]}"\n                    data-url="${this.attr["action-url"]}"\n                    `),e=r('<a href="{{href}}" class="btn btn-primary btn-action me-1 float-right" {{modal}}> {{text}} </a>',{href:t,text:this.attr["action-text"],modal:e})}"details-highlight"in this.attr&&(s=`<a href="#!">${this.attr["details-highlight"]}</a>`),this.className="activity",this.innerHTML=r('<div class="activity-icon bg-primary text-white shadow-primary"> <i class="fa-{{icon-type}} fa-{{icon}}"></i> </div> <div class="activity-detail"> <div class="mb-2"> <span class="text-job text-primary"> <h6>{{title}}</h6> </span> </div> {{action}} <p>{{details}} {{highlight}}</p> </div>',{"icon-type":this.attr["icon-type"],icon:this.attr.icon,title:this.attr.title,action:e,details:this.attr.details,highlight:s})}}),customElements.define("act-box",class extends s{constructor(){super()}_render(){this.className="activities"}add({icon:t={type:"solid",icon:"ellipsis"},title:e="Title",detail:s="Small details",focus:i=!1,action:a=!1}){const r=document.createElement("act-item");r.setAttribute("icon-type",t.type),r.setAttribute("icon",t.icon),r.setAttribute("title",e),r.setAttribute("details",s),i&&r.setAttribute("details-highlight",i),a&&"object"==typeof a&&(r.setAttribute("action-text",a.text),r.setAttribute("action-url",a.url),"modal"in a&&"object"==typeof a.modal&&(r.setAttribute("action-modal","object"==typeof a.modal),r.setAttribute("action-modal-title",a.modal.title))),this.append(r)}}),customElements.define("stock-change",class extends s{static observedAttributes=["getter","limit"];requiredAttributes=["getter"];castAttributes={limit:"integer"};constructor(){super(),this.page=0,this.gettingData=!1,this.attr={limit:5}}_render(){const t=this._validateAttr();if(t.error)return void console.error(t.message);this.style.maxHeight="70vh";const e=this.act=document.createElement("act-box"),s=this.getBTN=document.createElement("button");s.className="btn btn-outline-primary btn-icon",s.style.borderRadius="50%",s.innerHTML='<i class="fa-solid fa-arrow-down fa-2x"></i>',s.addEventListener("click",(t=>{this._getData()})),this.append(e),this.append(s),this._getData()}_appendAct(t=[]){t.forEach((t=>{const e=t.quantity>0?"plus":"minus",s=((t,e)=>{const s=new Date(t),i=document.documentElement.lang;return new Intl.DateTimeFormat([i,"id"],e).format(s)})(t.date,this._dateStyle);let i="",a=`(${(t=>{const e=document.documentElement.lang;return new Intl.NumberFormat([e,"id"]).format(t)})(t.quantity)}`;if(i="invoice_number"in t?t.invoice_number:"bill_number"in t?t.bill_number:t.description,"product"in t){const e=t.product;"unit"in e&&(a+=` ${e.unit.name}`)}a+=")",this.act.add({icon:{type:"solid",icon:e},title:s,detail:i,focus:a,action:!1})}))}_getData(){if(!this.gettingData){this.gettingData=!0;const t=this.getBTN.querySelector("i"),e=this.page;this.getBTN.disabled=!0,t.classList.remove("fa-arrow-down"),t.classList.add("fa-ellipsis");const s=new FormData;s.append("limit",this.attr.limit),s.append("page",++this.page),s.append("_token",document.querySelector('meta[name="csrf-token"]').getAttribute("content")),fetch(this.attr.getter,{method:"POST",headers:{accept:"application/json"},body:s}).then((t=>t.ok?t.json():(t.json().then((t=>console.error(t.message))),!1))).then((s=>{if(this.getBTN.disabled=!1,t.classList.remove("fa-ellipsis"),t.classList.add("fa-arrow-down"),s)this._dateStyle=s.date,this._maxPage=s.pages,this._appendAct(s.data),this.page==s.pages&&this.removeChild(this.getBTN);else if(e&&(this.page=e),1==this.page||this.page==this._maxPage){this.removeChild(this.getBTN);const t=r('<div class="text-center"> <i class="fa-solid fa-5x fa-box-open text-secondary"></i><br/> <span> <tl-str class="text-secondary">No older history</tl-str> </span> </div>');this.insertAdjacentHTML("beforeend",t)}setTimeout((()=>{this.gettingData=!1}),500)}))}}}),customElements.define("pg-tbl-cell",class extends s{static observedAttributes=["heading","renderable"];requiredAttributes=[];castAttributes={heading:"boolean",renderable:"boolean"};constructor(){super()}_render(){if(this.attr.renderable){const t=this.innerHTML;let e;e=this.attr.heading?`<th>${t}</th>`:`<td>${t}</td>`,this.outerHTML=outer}}}),customElements.define("pg-tbl-row",class extends s{static observedAttributes=["type","renderable"];requiredAttributes=["type"];castAttributes={type:["heading","data"],renderable:"boolean"};constructor(){super(),this._dataIsSet=!1}set data(t){this._dataIsSet=!0,this._data="string"==typeof t?JSON.parse(t):t,this._render()}_render(){if(this.attr.renderable){const t=this._validateAttr();if(t.error)return void console.error(t.message);let e;if("heading"==this.attr.type)this.querySelectorAll("pg-tbl-cell").forEach((t=>{t.setAttribute("heading",!0),t.setAttribute("renderable",!0)})),e=this.innerHTML;else if(this._dataIsSet)if(this._data)this.querySelectorAll("pg-cell").forEach((t=>{const e=t.innerHTML.match(/{(\w+)}/g);e&&e.forEach((e=>{e in this._data&&(t.innerHTML=t.innerHTML.replace(/{(\w+)}/g,this._data[$1]))})),t.setAttribute("renderable",!0)})),e=this.innerHTML;else{const t=this.querySelectorAll("pg-cell").length;e=r('<td colspan="{{colspan}}"> <tl-str>No Data</tl-str> </td>',{colspan:t})}this.outerHTML=`<tr>${e}</tr>`}}}),customElements.define("pg-tbl-header",class extends s{static observedAttributes=[];requiredAttributes=[];castAttributes={};constructor(){super()}_render(){this.querySelectorAll("pg-tbl-row").forEach((t=>{t.setAttribute("type","heading"),t.setAttribute("renderable",!0)})),this.outerHTML=`<thead>${this.innerHTML}</thead>`}}),customElements.define("pg-next",class extends s{static observedAttributes=["page","max"];castAttributes={page:"integer",max:"integer"};requiredAttributes=["page","max"];constructor(){super(),this.addEventListener("click",(t=>{this.attr.max!=this.attr.page&&this._callback&&"function"==typeof this._callback&&this._callback(this.attr.page+1)}))}_render(){const t=this._validateAttr();t.error?console.warn(t.message):(this.innerHTML||(this.innerHTML=r('<a class="page-link" href="#"> <tl-str>Next</tl-str> </a>'),this.classList.add("page-item")),this.attr.max==this.attr.page?this.classList.add("disabled"):this.classList.contains("disabled")&&this.classList.remove("disabled"))}set callback(t=(t=>!1)){this._callback=t}}),customElements.define("pg-prev",class extends s{static observedAttributes=["page"];castAttributes={page:"integer"};requiredAttributes=["page"];constructor(){super(),this.addEventListener("click",(t=>{console.log("Prev"),1!=this.attr.page&&this._callback&&"function"==typeof this._callback&&this._callback(this.attr.page-1)}))}_render(){const t=this._validateAttr();t.error?console.warn(t.message):(this.innerHTML||(this.innerHTML=r('<a class="page-link" href="#"> <tl-str>Prev</tl-str> </a>'),this.classList.add("page-item")),1==this.attr.page?this.classList.add("disabled"):this.classList.contains("disabled")&&this.classList.remove("disabled"))}set callback(t=(t=>!1)){this._callback=t}}),customElements.define("pg-number",class extends s{static observedAttributes=["active","page"];castAttributes={active:"boolean",page:"integer"};constructor(){super(),this.addEventListener("click",(t=>{this.attr.page&&!this.attr.active&&this._callback&&"function"==typeof this._callback&&this._callback(this.attr.page)}))}_render(){this.classList.contains("page-item")||this.classList.add("page-item"),this.attr.active?this.classList.add("active"):this.classList.contains("active")&&this.classList.remove("active"),this.attr.page?(this.classList.contains("disabled")&&this.classList.remove("disabled"),this.innerHTML=r('<a class="page-link" href="#">{{number}}</a>',{number:this.attr.page})):(this.classList.contains("disabled")||this.classList.add("disabled"),this.innerHTML=r('<a class="page-link">&hellip;</a>'))}set callback(t=(t=>!1)){this._callback=t}}),customElements.define("pg-list",class extends s{static observedAttributes=["page","max"];castAttributes={page:"integer",max:"integer"};requiredAttributes=["page","max"];constructor(){super(),this._callback=t=>{t<=this.attr.max&&this.setAttribute("page",t)}}_render(){const t=this._validateAttr();if(t.error)return void console.warn(t.message);this.innerHTML||(this.classList.add("pagination"),this.innerHTML=r('<pg-prev></pg-prev> <pg-number class="d-none"></pg-number> <pg-number class="d-none"></pg-number> <pg-number class="d-none"></pg-number> <pg-number class="d-none"></pg-number> <pg-number class="d-none"></pg-number> <pg-number class="d-none"></pg-number> <pg-number class="d-none"></pg-number> <pg-number class="d-none"></pg-number> <pg-number class="d-none"></pg-number> <pg-next></pg-next>')),this._prevPage||(this._prevPage=this.querySelector("pg-prev"),this._prevPage.callback=this._callback),this._nextPage||(this._nextPage=this.querySelector("pg-next"),this._nextPage.callback=this._callback),this._numbers||(this._numbers=this.querySelectorAll("pg-number"),this._numbers.forEach((t=>{t.callback=this._callback}))),this._prevPage.setAttribute("page",this.attr.page),this._nextPage.setAttribute("page",this.attr.page),this._nextPage.setAttribute("max",this.attr.max);let e=1;this._numbers.forEach((t=>{1==e||e>this.attr.page-3&&e<this.attr.page+3&&e<=this.attr.max||e==this.attr.max?(t.setAttribute("page",e),t.classList.contains("d-none")&&t.classList.remove("d-none"),e==this.attr.page?t.setAttribute("active",!0):t.setAttribute("active",!1)):e>1&&e<=this.attr.page-3?(t.classList.contains("d-none")&&t.classList.remove("d-none"),t.removeAttribute("page"),e=this.attr.page-3):e>=this.attr.page+3&&e<this.attr.max?(t.classList.contains("d-none")&&t.classList.remove("d-none"),t.removeAttribute("page"),e=this.attr.max-1):t.classList.contains("d-none")||(t.classList.add("d-none"),t.setAttribute("page",0),t.setAttribute("active",!1)),e++}))}set callback(t=(t=>!1)){this._callback=e=>{e<=this.attr.max&&(this.setAttribute("page",e),t(e))},this._prevPage&&(this._prevPage.callback=this._callback),this._nextPage&&(this._nextPage.callback=this._callback),this._numbers&&this._numbers.forEach((t=>{t.callback=this._callback}))}}),t})()));